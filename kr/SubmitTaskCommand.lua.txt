class("SubmitTaskCommand", pm.SimpleCommand).execute = function (slot0, slot1)
	if not getProxy(TaskProxy):getTaskById(slot1:getBody()) then
		pg.TipsMgr:GetInstance():ShowTips(i18n("task_is_not_existence", slot2))

		return
	end

	if not slot4:isFinish() then
		pg.TipsMgr:GetInstance():ShowTips(i18n("task_submitTask_error_notFinish"))

		return
	end

	pg.ConnectionMgr.GetInstance():Send(20005, {
		id = slot4.id
	}, 20006, function (slot0)
		if slot0.result == 0 then
			if slot0:getConfig("sub_type") == TASK_SUB_TYPE_GIVE_ITEM then
				getProxy(BagProxy):removeItemById(tonumber(slot2), tonumber(slot0:getConfig("target_num")))
			elseif slot0:getConfig("sub_type") == TASK_SUB_TYPE_PLAYER_RES then
				slot3 = getProxy(PlayerProxy)
				slot4 = slot3:getData()

				slot4:consume({
					[id2res(slot0:getConfig("target_id_for_client"))] = slot0:getConfig("target_num")
				})
				slot3:updatePlayer(slot4)
			end

			for slot5, slot6 in pairs(slot1) do
				if slot6.type ~= DROP_TYPE_SHIP then
					slot1:sendNotification(GAME.ADD_ITEM, slot6)
				end
			end

			if slot0:getConfig("type") ~= 8 then
				slot2:removeTask(slot0)
			else
				slot0.submitTime = 1

				slot0:updateTask(slot0)
			end

			slot1:sendNotification(GAME.SUBMIT_TASK_DONE, slot1)

			if getProxy(ActivityProxy):getActivityByType(ActivityConst.ACTIVITY_TYPE_TASK_LIST_MONITOR) and not slot3:isEnd() and table.contains(slot3:getConfig("config_data")[1] or {}, slot0.id) then
				slot2:monitorTaskList(slot3)
			end
		else
			pg.TipsMgr:GetInstance():ShowTips(errorTip("task_submitTask", slot0.result))
		end
	end)
end

return class("SubmitTaskCommand", pm.SimpleCommand)
